Query Problem 1

1.1

SELECT * FROM FILM WHERE FILM_ID IN (SELECT FILM_ID FROM FILM_CATEGORY WHERE CATEGORY_ID IN (SELECT CATEGORY_ID FROM CATEGORY WHERE NAME = 'Comedy')) AND RATING = 'PG-13';

1.2

CREATE VIEW TOP3HORROR AS
SELECT INVENTORY_ID,COUNT(*) AS COUNT FROM RENTAL WHERE INVENTORY_ID IN 
(SELECT INVENTORY_ID FROM INVENTORY WHERE FILM_ID IN 
(SELECT FILM_ID FROM FILM_CATEGORY WHERE CATEGORY_ID IN
(SELECT CATEGORY_ID FROM CATEGORY WHERE NAME = 'Horror'))) 
GROUP BY INVENTORY_ID ORDER BY COUNT DESC LIMIT 3;

SELECT * FROM INVENTORY INNER JOIN FILM ON INVENTORY.FILM_ID = FILM.FILM_ID WHERE INVENTORY_ID IN (SELECT INVENTORY_ID FROM TOP3HORROR);

1.3

CREATE VIEW SPORTSMOVIE AS
SELECT INVENTORY_ID FROM RENTAL WHERE INVENTORY_ID IN 
(SELECT INVENTORY_ID FROM INVENTORY WHERE FILM_ID IN 
(SELECT FILM_ID FROM FILM_CATEGORY WHERE CATEGORY_ID IN
(SELECT CATEGORY_ID FROM CATEGORY WHERE NAME = 'Sports')));

SELECT * FROM CUSTOMER WHERE CUSTOMER_ID IN 
(SELECT DISTINCT CUSTOMER_ID FROM SPORTSMOVIE WHERE CUSTOMER_ID IN 
(SELECT CUSTOMER_ID FROM CUSTOMER INNER JOIN ADDRESS ON CUSTOMER.ADDRESS_ID = ADDRESS.ADDRESS_ID WHERE CITY_ID IN 
(SELECT CITY_ID FROM CITY WHERE CITY.COUNTRY_ID IN 
(SELECT COUNTRY_ID FROM COUNTRY WHERE country='India' ))));

1.4

CREATE VIEW NICKWAHLBERGMOVIES AS
SELECT INVENTORY_ID FROM RENTAL WHERE INVENTORY_ID IN 
(SELECT INVENTORY_ID FROM INVENTORY WHERE FILM_ID IN 
(SELECT FILM_ID FROM FILM_ACTOR WHERE ACTOR_ID IN
(SELECT ACTOR_ID FROM ACTOR WHERE first_name='Nick' AND last_name='Wahlberg')));

SELECT * FROM CUSTOMER WHERE CUSTOMER_ID IN 
(SELECT DISTINCT CUSTOMER_ID FROM NICKWAHLBERGMOVIES WHERE CUSTOMER_ID IN 
(SELECT CUSTOMER_ID FROM CUSTOMER INNER JOIN ADDRESS ON CUSTOMER.ADDRESS_ID = ADDRESS.ADDRESS_ID WHERE CITY_ID IN 
(SELECT CITY_ID FROM CITY WHERE CITY.COUNTRY_ID IN 
(SELECT COUNTRY_ID FROM COUNTRY WHERE country='Canada' ))));

1.5

SELECT * FROM FILM WHERE FILM_ID IN(
SELECT FILM_ID FROM FILM_ACTOR WHERE ACTOR_ID IN
(SELECT ACTOR_ID FROM ACTOR WHERE first_name='Sean' AND last_name='Williams'));

