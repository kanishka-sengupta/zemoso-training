QUERY 2

2.1

SELECT * FROM FILM WHERE FILM_ID IN 
(SELECT FILM_ID FROM FILM_CATEGORY WHERE CATEGORY_ID IN(SELECT CATEGORY_ID FROM CATEGORY WHERE NAME = 'Documentary')) 
AND 'Deleted Scenes' = ANY(special_features);

2.2


CREATE OR REPLACE VIEW SCIFIMOVIE AS                                                                                    
SELECT INVENTORY_ID,STAFF_ID FROM RENTAL WHERE INVENTORY_ID IN 
(SELECT INVENTORY_ID FROM INVENTORY WHERE FILM_ID IN 
(SELECT FILM_ID FROM FILM_CATEGORY WHERE CATEGORY_ID IN
(SELECT CATEGORY_ID FROM CATEGORY WHERE NAME = 'Sci-Fi')));

SELECT COUNT(*) FROM SCIFIMOVIE WHERE STAFF_ID IN (SELECT STAFF_ID FROM STAFF WHERE first_name='Jon' AND last_name='Stephens');

2.3
CREATE OR REPLACE VIEW ANIMATIONMOVIES AS 
SELECT INVENTORY_ID FROM RENTAL WHERE INVENTORY_ID IN 
(SELECT INVENTORY_ID FROM INVENTORY WHERE FILM_ID IN 
(SELECT FILM_ID FROM FILM_CATEGORY WHERE CATEGORY_ID IN
(SELECT CATEGORY_ID FROM CATEGORY WHERE NAME = 'Animation')));

SELECT SUM(RENTAL_RATE) FROM ANIMATIONMOVIES INNER JOIN INVENTORY ON INVENTORY.INVENTORY_ID = ANIMATIONMOVIES.INVENTORY_ID INNER JOIN FILM ON INVENTORY.FILM_ID = FILM.FILM_ID;


2.4

SELECT NAME,FILM_CATEGORY.CATEGORY_ID,COUNT(FILM_CATEGORY.CATEGORY_ID) 
FROM FILM_CATEGORY INNER JOIN CATEGORY ON FILM_CATEGORY.CATEGORY_ID=CATEGORY.CATEGORY_ID WHERE FILM_ID IN
(SELECT film_id FROM RENTAL  INNER JOIN INVENTORY ON RENTAL.INVENTORY_ID = INVENTORY.INVENTORY_ID WHERE CUSTOMER_ID IN
(SELECT CUSTOMER_ID FROM CUSTOMER WHERE first_name='Patricia' AND last_name='Johnson')) 
GROUP BY FILM_CATEGORY.CATEGORY_ID,NAME ORDER BY COUNT DESC LIMIT 3;

2.5

SELECT * FROM FILM WHERE FILM_ID IN 
(SELECT film_id FROM RENTAL  INNER JOIN INVENTORY ON RENTAL.INVENTORY_ID = INVENTORY.INVENTORY_ID WHERE CUSTOMER_ID IN
(SELECT CUSTOMER_ID FROM CUSTOMER WHERE first_name='Susan' AND last_name='Wilson')) AND RATING='R';



